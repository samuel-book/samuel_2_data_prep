

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Disability at six months (results) &#8212; SAMueL-2 Descriptive Analysis</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'sam2_disability_6months_results';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Thrombectomy" href="sam2_thrombectomy.html" />
    <link rel="prev" title="Disability at six months (completion)" href="sam2_disability_6months_completion.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    <p class="title logo__title">SAMueL-2 Descriptive Analysis</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Descriptive analysis
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Set up</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="01_reformat_data.html">Reformat data</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SAMueL-1</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sam1_pathway_statistics.html">Descriptive analysis of stroke pathway data</a></li>
<li class="toctree-l1"><a class="reference internal" href="sam1_thrombolysis_associations.html">Associations between thrombolysis use and patient features</a></li>
<li class="toctree-l1"><a class="reference internal" href="sam1_compare_by_thrombolysis.html">Comparison between patients who received thrombolysis versus not</a></li>
<li class="toctree-l1"><a class="reference internal" href="sam1_day_week_pathway_patterns.html">Daily and weekly pathway patterns</a></li>
<li class="toctree-l1"><a class="reference internal" href="sam1_pathway_distributions.html">Stroke pathway timing distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="sam1_correlations.html">Covariance/correlation between features</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SAMueL-2 (detailed/complete)</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sam2_disability_6months_completion.html">Disability at six months (completion)</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Disability at six months (results)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sam2_thrombectomy.html">Thrombectomy</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">SAMUeL-2 (incomplete)</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sam2_ambulance.html">Ambulance</a></li>
<li class="toctree-l1"><a class="reference internal" href="sam2_size_associations.html">Associations with number of admissions</a></li>
<li class="toctree-l1"><a class="reference internal" href="sam2_compare_years.html">Year by year comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="sam2_disability_discharge.html">Thrombolysis outcomes</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fsam2_disability_6months_results.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/sam2_disability_6months_results.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Disability at six months (results)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#context-about-measurement-of-disability">Context about measurement of disability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aims">Aims</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#purpose-of-this-analysis">Purpose of this analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#caveats">Caveats</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up">Set up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reformat-dataset">Reformat dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#disability-at-six-months-and-change-from-discharge">Disability at six months (and change from discharge)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factors-associated-with-disability-at-six-months">Factors associated with disability at six months</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factors-associated-with-change-in-disability">Factors associated with change in disability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-linear-regression">Multiple linear regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transform-data-fit-model-and-collect-evaluation-metrics">Transform data, fit model, and collect evaluation metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-results">Review results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#standardised-results">Standardised results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#unstandardised-results">Unstandardised results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions">Assumptions</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="disability-at-six-months-results">
<h1>Disability at six months (results)<a class="headerlink" href="#disability-at-six-months-results" title="Permalink to this headline">#</a></h1>
<p>In this notebook, we explore disability at 6 months and the change in disability between discharge and six months.</p>
<div class="section" id="context-about-measurement-of-disability">
<h2>Context about measurement of disability<a class="headerlink" href="#context-about-measurement-of-disability" title="Permalink to this headline">#</a></h2>
<p>Disability is measured using the modified Rankin Scale (mRS). The scale ranges from 0 to 6, where 0 is perfect health without symptoms and 6 is death. The dataset contains information on:</p>
<ul class="simple">
<li><p>Disability before the stroke</p></li>
<li><p>Disability at discharge</p></li>
<li><p>Disability at six months</p></li>
</ul>
</div>
<div class="section" id="aims">
<h2>Aims<a class="headerlink" href="#aims" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Investigate disability at six months</p></li>
<li><p>Investigate the change in disability between discharge and six months</p></li>
</ul>
</div>
<div class="section" id="purpose-of-this-analysis">
<h2>Purpose of this analysis<a class="headerlink" href="#purpose-of-this-analysis" title="Permalink to this headline">#</a></h2>
<p>In other analyses, we are using discharge disability. One reason for that is because six month disability is so incomplete.</p>
<p>However, understanding the relationship between discharge disability and six month disability is useful context, if you were to start thinking about more long-term outcomes. There should be alot of sceptism around this analysis, however, as we believe that data on six month disability is not missing at random.</p>
</div>
<div class="section" id="caveats">
<h2>Caveats<a class="headerlink" href="#caveats" title="Permalink to this headline">#</a></h2>
<p>Caveats of this data and analysis include…</p>
<p><strong>Follow-up is not missing at random.</strong> Lots of patients are missing data on disability at six months, and this information is not missing at random. We know that the likelihood of having a follow-up assessment may be influenced by several different factors. We know that disability (including death) at six months is input manually (and so, case ascertainment is not more reliable for those died, but will vary between providers, as with the input of all mRS scores at 6 months). There are some SSNAP reports on their website where they link to mortality data from ONS once per year to report on mortality, but we do not have access to that.</p>
<p><strong>Variation in follow up date.</strong> SSNAP data is provided for patients with a “follow-up assessment at six months post admission (plus or minus two months). This means that the data can actually be from 4 to 8 months after admission, which is a large amount of variability. It is possible that this variation may not be random (and that certain patients are more or less likely to be followed up earlier or later).</p>
<p><strong>Variation in discharge date.</strong> SSNAP data on disability after stroke is provided for the point of discharge, but different patients will have different lengths of stay (likely influenced by patient/clinical characteristics). This means we are comparing disability that could be at very different lengths of time after the stroke.</p>
<p><strong>Disability is ordinal.</strong> Disability is measured using mRS which is an ordinal scale - i.e. the categories have an order but there is not a consistent space between each score on the scale. This is one reason why some other analyses are focussing on utility, and we know the difference in utility for mRS 0 to mRS 3 is the difference between mRS 4 and 5, which indicates that a change from 4 to 5 reflects a greater change in health related quality of life than 0 to 1, and potentially a greater functional change.</p>
<p><strong>Confounders:</strong> Change in disability could be due to factors besides stroke - such as other conditions not captured here.</p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><strong>Mean disability:</strong> Mean 6-month disability 2.18 (n=109,321) and mean discharge disability 2.65 (n=356,355) - two different samples</p></li>
<li><p><strong>Distribution of change in disability:</strong> Focussing on patients with discharge and 6-month disability, we most frequently see no change in disability (31.5%), then a change of one mRS score (apx. 40%), then two mRS (apx. 18%), three mRS (apx. 6%), and then very few with a change of four mRS or more</p></li>
<li><p><strong>Factors associated with six month disability:</strong> Using descriptive analysis, we see worse disability at six months for patients with greater prior or discharge disability, greater stroke severity, and older age. There is little difference between thrombolysed and non-thrombolysed patients.</p></li>
<li><p><strong>Factors associated with change in disability:</strong></p>
<ul>
<li><p>Using descriptive analysis, looking at change in disability from discharge to six months, we see patterns that match with the prior analysis, but with the addition of impacts from scale used - i.e. patient with discharge disability of 0 has no scope to improve, and patient with discharge disability of 5 cannot worsen by more than 1, and so on. Looking at the proportion who stay the same, worsen or improve, the majority of patients with a discharge disability of 2, 3 or 4 are better at six months, and the majority with a score of 0 or 5 are worse.</p></li>
<li><p>Multiple linear regression finds discharge disability and thrombolysis are associated with improving disability from discharge, whilst prior disability, stroke severity and age are associated with decline. However, as above, some of this is artefacts of scale - if you have a higher discharge disability, you have more scope to improve.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="set-up">
<h2>Set up<a class="headerlink" href="#set-up" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import packages and functions</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span><span class="p">,</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">,</span>
                             <span class="n">r2_score</span><span class="p">,</span> <span class="n">confusion_matrix</span><span class="p">)</span>

<span class="c1"># Set max rows when display dataframe</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Linting</span>
<span class="o">%</span><span class="k">load_ext</span> pycodestyle_magic
<span class="o">%</span><span class="k">pycodestyle_on</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set paths and filenames</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Paths</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;Singleton object for storing paths to data and files.&#39;&#39;&#39;</span>

    <span class="n">data_path</span> <span class="o">=</span> <span class="s1">&#39;./../output/&#39;</span>
    <span class="n">data_filename</span> <span class="o">=</span> <span class="s1">&#39;reformatted_data.csv&#39;</span>
    <span class="n">admission_only_filename</span> <span class="o">=</span> <span class="s1">&#39;reformatted_data_admissions_only.csv&#39;</span>


<span class="n">paths</span> <span class="o">=</span> <span class="n">Paths</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load data</span>
<span class="n">data_full</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">paths</span><span class="o">.</span><span class="n">data_path</span><span class="p">,</span>
                                     <span class="n">paths</span><span class="o">.</span><span class="n">admission_only_filename</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reformat-dataset">
<h2>Reformat dataset<a class="headerlink" href="#reformat-dataset" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Restrict to individuals not dead at discharge</span>
<span class="n">data_full_alive</span> <span class="o">=</span> <span class="n">data_full</span><span class="p">[</span><span class="n">data_full</span><span class="p">[</span><span class="s1">&#39;death&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># Create stroke severity column with groups so can plot in same way as others</span>
<span class="n">conditions</span> <span class="o">=</span> <span class="p">[(</span><span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;stroke_severity&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">),</span>
              <span class="p">(</span><span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;stroke_severity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">))),</span>
              <span class="p">(</span><span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;stroke_severity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">))),</span>
              <span class="p">(</span><span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;stroke_severity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">21</span><span class="p">))),</span>
              <span class="p">(</span><span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;stroke_severity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">43</span><span class="p">)))]</span>
<span class="n">nihss_choices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span> <span class="s1">&#39;1-4&#39;</span><span class="p">,</span> <span class="s1">&#39;5-15&#39;</span><span class="p">,</span> <span class="s1">&#39;16-20&#39;</span><span class="p">,</span> <span class="s1">&#39;21-42&#39;</span><span class="p">]</span>
<span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;stroke_severity_groups&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">conditions</span><span class="p">,</span>
                                                      <span class="n">nihss_choices</span><span class="p">)</span>

<span class="c1"># Create column with change in disability from discharge to 6 months</span>
<span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;discharge_to_6_month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;disability_6_month&#39;</span><span class="p">]</span> <span class="o">-</span>
    <span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;discharge_disability&#39;</span><span class="p">])</span>

<span class="c1"># Restrict to individuals with 6 month disability</span>
<span class="n">data_full_alive_change</span> <span class="o">=</span> <span class="n">data_full_alive</span><span class="p">[</span>
    <span class="o">~</span><span class="n">data_full_alive</span><span class="p">[</span><span class="s1">&#39;disability_6_month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="disability-at-six-months-and-change-from-discharge">
<h2>Disability at six months (and change from discharge)<a class="headerlink" href="#disability-at-six-months-and-change-from-discharge" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Describe average disability at each timepoint</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">data_full</span><span class="p">[</span><span class="s1">&#39;discharge_disability&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">(),</span>
           <span class="n">data_full</span><span class="p">[</span><span class="s1">&#39;disability_6_month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>discharge_disability</th>
      <th>disability_6_month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>356355.000000</td>
      <td>109321.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>2.649933</td>
      <td>2.176947</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.919072</td>
      <td>1.807213</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>2.000000</td>
      <td>2.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>4.000000</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>6.000000</td>
      <td>6.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Observations: There are 109,321 patients with data on six month disability, with a mean mRS score of 2.18 and median score of 2. This is lower than the average disability of the 356,355 patients with discharge disability recorded, which was a mean of 2.65.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">describe_disability</span><span class="p">(</span><span class="n">timepoint</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    For the specified timepoint, describe the proportion of people</span>
<span class="sd">    with each disability score and present in a plot</span>
<span class="sd">    timepoint: string e.g. discharge_disability</span>
<span class="sd">    ax: axes object to create plot on</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Find and display proportion of people with each score</span>
    <span class="n">mrs_6m</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_full</span><span class="p">[</span><span class="n">timepoint</span><span class="p">]</span>
              <span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
              <span class="o">.</span><span class="n">sort_index</span><span class="p">())</span>

    <span class="c1"># Create plot</span>
    <span class="n">mrs_6m</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">timepoint</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Proportion&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>

    <span class="c1"># Return results</span>
    <span class="k">return</span> <span class="n">mrs_6m</span>


<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">mrs_discharge</span> <span class="o">=</span> <span class="n">describe_disability</span><span class="p">(</span><span class="s1">&#39;discharge_disability&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">mrs_6months</span> <span class="o">=</span> <span class="n">describe_disability</span><span class="p">(</span><span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">display</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">mrs_discharge</span><span class="p">,</span> <span class="n">mrs_6months</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>discharge_disability</th>
      <th>disability_6_month</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.0</th>
      <td>0.130185</td>
      <td>0.164580</td>
    </tr>
    <tr>
      <th>1.0</th>
      <td>0.212566</td>
      <td>0.288078</td>
    </tr>
    <tr>
      <th>2.0</th>
      <td>0.183115</td>
      <td>0.189781</td>
    </tr>
    <tr>
      <th>3.0</th>
      <td>0.161376</td>
      <td>0.156841</td>
    </tr>
    <tr>
      <th>4.0</th>
      <td>0.116603</td>
      <td>0.070654</td>
    </tr>
    <tr>
      <th>5.0</th>
      <td>0.056334</td>
      <td>0.024231</td>
    </tr>
    <tr>
      <th>6.0</th>
      <td>0.139821</td>
      <td>0.105835</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/d10c55ead1dee328723025e4a769fd5487e5957ca56e0864d96bee5837070be9.png" src="_images/d10c55ead1dee328723025e4a769fd5487e5957ca56e0864d96bee5837070be9.png" />
</div>
</div>
<p><strong>Remember!</strong> These are two different samples.</p>
<p>Observations: A greater proportion of patients at six months have lower mRS scores - e.g. 28.8% mRS 1 at six months, versus 21.2% at discharge. Conversely, a lower proportion of patients at six months have higher mRS scores - e.g. 10.6% mRS 6 at six months, versus 14.0% at discharge.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate change in disability</span>
<span class="n">mrs_change</span> <span class="o">=</span> <span class="n">data_full_alive_change</span><span class="p">[</span><span class="s1">&#39;discharge_to_6_month&#39;</span><span class="p">]</span>

<span class="c1"># Describe average change</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mrs_change</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="c1"># Find proportion with each change</span>
<span class="n">mrs_change_prop</span> <span class="o">=</span> <span class="n">mrs_change</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">mrs_change_prop</span><span class="p">)</span>

<span class="c1"># Visualise distribution of changes</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">mrs_change_prop</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Change in disability from discharge to 6 months&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Proportion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    109321.00000
mean          0.11533
std           1.52376
min          -5.00000
25%          -1.00000
50%           0.00000
75%           1.00000
max           6.00000
Name: discharge_to_6_month, dtype: float64
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-5.0    0.000201
-4.0    0.003183
-3.0    0.024177
-2.0    0.092041
-1.0    0.218979
 0.0    0.315283
 1.0    0.196248
 2.0    0.086635
 3.0    0.035849
 4.0    0.013803
 5.0    0.009230
 6.0    0.004372
Name: discharge_to_6_month, dtype: float64
</pre></div>
</div>
<img alt="_images/5d7d349260a5530ca8fb19c67e94947e3cabf0baf47e020a25d06cd6c27aa305.png" src="_images/5d7d349260a5530ca8fb19c67e94947e3cabf0baf47e020a25d06cd6c27aa305.png" />
</div>
</div>
<p><strong>Remember!</strong> This is just the sample of people with disability recorded at 6 months.</p>
<p>Observations: We see a mean change of 0.1 (worsening). Looking at the distribution of results -</p>
<ul class="simple">
<li><p><strong>Most frequently see no change</strong> in disability (31.5%)</p></li>
<li><p><strong>Looking at one or two mRS change, we see more people getting better</strong>. One mRS better for 21.9% and one mRS worse for 19.6%. Two mRS better for 9.2% and two mRS worse for 8.7%</p></li>
<li><p><strong>Looking at a change of 3 mRS or more, we see more people getting worse</strong>. Three mRS better for 2.4% and three mRS worse for 3.6%. Very few of a change of four mRS or more. There are very few patients with four mRS (0.3%) or five mRS (0.02%) better. There are slightly more with worsening mRS - four mRS (0.1%), five mRS (0.09%) or six mRS (0.04%) worse</p></li>
</ul>
</div>
<div class="section" id="factors-associated-with-disability-at-six-months">
<h2>Factors associated with disability at six months<a class="headerlink" href="#factors-associated-with-disability-at-six-months" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">boxplot_6_month</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">xfontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Create box plot of the distribution of</span>
<span class="sd">    disability at 6 months, grouped by the specified variable</span>
<span class="sd">    Inputs:</span>
<span class="sd">    variable - string, variable to group by</span>
<span class="sd">    outcome - string, disability outcome to plot</span>
<span class="sd">    ax - axis object to plot on</span>
<span class="sd">    positions - array defining order for x axis (default False)</span>
<span class="sd">    xfontsize - integer, fontsize for x tick labels (default 10)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Extract values by group</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_full_alive_change</span>
              <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">variable</span><span class="p">)[</span><span class="n">outcome</span><span class="p">]</span>
              <span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>

    <span class="c1"># Create box plot, ordered by positions if provided</span>
    <span class="k">if</span> <span class="n">positions</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">positions</span><span class="o">=</span><span class="n">positions</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

    <span class="c1"># Add appropriate labels</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">variable</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">xfontsize</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">outcome</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">stacked_bar_6_month</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="n">outcome</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Creates stacked bar of disability at 6 months, when patients are</span>
<span class="sd">    grouped by the specified variable</span>
<span class="sd">    Inputs:</span>
<span class="sd">    variable - string, e.g. &#39;prior_disability&#39;</span>
<span class="sd">    outcome - string, disability outcome to plot</span>
<span class="sd">    ax - axis object to plot on</span>
<span class="sd">    order - array defining order for x axis (default False)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_full_alive_change</span>
          <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">variable</span><span class="p">)[</span><span class="n">outcome</span><span class="p">]</span>
          <span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
          <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;prop&#39;</span><span class="p">)</span>
          <span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">outcome</span><span class="p">,</span>
                 <span class="n">index</span><span class="o">=</span><span class="n">variable</span><span class="p">,</span>
                 <span class="n">values</span><span class="o">=</span><span class="s1">&#39;prop&#39;</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">order</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">order</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">stacked</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Proportion&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create box plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;prior_disability&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;discharge_disability&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;stroke_severity_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;thrombolysis&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">xfontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># Remove empty axis, resize and show</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Create stacked bar charts</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">stacked_bar_6_month</span><span class="p">(</span><span class="s1">&#39;prior_disability&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">stacked_bar_6_month</span><span class="p">(</span><span class="s1">&#39;discharge_disability&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">stacked_bar_6_month</span><span class="p">(</span><span class="s1">&#39;stroke_severity_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                    <span class="n">order</span><span class="o">=</span><span class="n">nihss_choices</span><span class="p">)</span>
<span class="n">stacked_bar_6_month</span><span class="p">(</span><span class="s1">&#39;thrombolysis&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">stacked_bar_6_month</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="c1"># Resize plots and add back in a legend</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Disability at 6 months&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6a7714f5ca8dc2f16f7add6af985cc72686532872f8996404b3fca4712ada188.png" src="_images/6a7714f5ca8dc2f16f7add6af985cc72686532872f8996404b3fca4712ada188.png" />
<img alt="_images/567a6e580ab30c874923e639088609f8b121ffd448dc8de7807636c53703efc1.png" src="_images/567a6e580ab30c874923e639088609f8b121ffd448dc8de7807636c53703efc1.png" />
</div>
</div>
<p><strong>Observations:</strong></p>
<ul class="simple">
<li><p><strong>Prior disability and discharge disability</strong> - on average, patients with greater prior or discharge disability have greater disability at six months, and vice versa. The majority of patients with a prior or discharge disability of 5 having died at six months.</p></li>
<li><p><strong>Stroke severity</strong> - patients with a higher stroke severity typically have a worse six month disability, and likewise a greater proportion have worse disability scores</p></li>
<li><p><strong>Thrombolysis</strong> - on average, a slightly higher proportion of thrombolysed patients have a six month disability score of 0 - but we see little difference when only grouping by whether thrombolysed or not</p></li>
<li><p><strong>Age</strong> - patients with older ages typically have a worse six month disability</p></li>
</ul>
</div>
<div class="section" id="factors-associated-with-change-in-disability">
<h2>Factors associated with change in disability<a class="headerlink" href="#factors-associated-with-change-in-disability" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create box plots</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;prior_disability&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_to_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;discharge_disability&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_to_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;stroke_severity_groups&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_to_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                <span class="n">positions</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;thrombolysis&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_to_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">boxplot_6_month</span><span class="p">(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_to_6_month&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">xfontsize</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="c1"># Remove empty axis, resize and show</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/db490ef905434e6578c2c4ef0480ddd581a46c2a5697ae2b38d0df236061e652.png" src="_images/db490ef905434e6578c2c4ef0480ddd581a46c2a5697ae2b38d0df236061e652.png" />
</div>
</div>
<p><strong>Observations:</strong> We see anticipated patterns, given the results when looking at disability at six months. However, we also see some results that reflect the scales used - for example:</p>
<ul class="simple">
<li><p>Patients with a discharge disability of 0 on average worsen with no results where a score improve (but that is because they have no scope to improve as they were at 0 already) Similar patterns to above, but with outcome of change in disability.</p></li>
<li><p>Likewise, patients with a discharge disability of 5 cannot improve by more than 1. Patients with a discharge disability of 4 cannot improve by more than 2. And so on.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_disability_change</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    For groups of patients with each discharge disability score, create a</span>
<span class="sd">    plot visualising the proportion whose scores were the same, better or</span>
<span class="sd">    worse at six months</span>
<span class="sd">    Inputs</span>
<span class="sd">    df: dataframe containing disability at discharge and six months</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Extract individuals with complete data at followup</span>
    <span class="n">mrs_compare</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;disability_6_month&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_disability&#39;</span><span class="p">]]</span>
                   <span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
                   <span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;disability_6_month&#39;</span><span class="p">:</span> <span class="s1">&#39;followup&#39;</span><span class="p">,</span>
                                    <span class="s1">&#39;discharge_disability&#39;</span><span class="p">:</span> <span class="s1">&#39;discharge&#39;</span><span class="p">}))</span>

    <span class="c1"># Compare 6 month disability to discharge disability</span>
    <span class="n">mrs_compare</span><span class="p">[</span><span class="s1">&#39;compare&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">mrs_compare</span><span class="p">[</span><span class="s1">&#39;followup&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">mrs_compare</span><span class="p">[</span><span class="s1">&#39;discharge&#39;</span><span class="p">],</span> <span class="s1">&#39;Worse&#39;</span><span class="p">,</span>
        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">mrs_compare</span><span class="p">[</span><span class="s1">&#39;followup&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">mrs_compare</span><span class="p">[</span><span class="s1">&#39;discharge&#39;</span><span class="p">],</span>
                 <span class="s1">&#39;Better&#39;</span><span class="p">,</span> <span class="s1">&#39;Same&#39;</span><span class="p">))</span>

    <span class="c1"># Find proportion better, same or worse - by discharge disability</span>
    <span class="n">mrs_compare_3</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">mrs_compare</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;discharge&#39;</span><span class="p">)[</span><span class="s1">&#39;compare&#39;</span><span class="p">]</span>
        <span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">dropna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;prop&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;discharge&#39;</span><span class="p">,</span> <span class="s1">&#39;compare&#39;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s1">&#39;discharge&#39;</span><span class="p">,</span>
               <span class="n">columns</span><span class="o">=</span><span class="s1">&#39;compare&#39;</span><span class="p">,</span>
               <span class="n">values</span><span class="o">=</span><span class="s1">&#39;prop&#39;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

    <span class="c1"># Plot these results</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">mrs_compare_3</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Discharge disability&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Proportion of patients&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Disability at 6 months (compared to discharge)&#39;</span><span class="p">,</span>
              <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper center&#39;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;For each discharge mRS score, proportion of patients&#39;</span> <span class="o">+</span>
                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">who had better, same or worse score at 6-month follow-up&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">plot_disability_change</span><span class="p">(</span><span class="n">data_full_alive</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f229b2b0fd3da71d25d5cd93e2a0b7ccadb0bda82f745d7471e25e4bac2253ac.png" src="_images/f229b2b0fd3da71d25d5cd93e2a0b7ccadb0bda82f745d7471e25e4bac2253ac.png" />
</div>
</div>
<p>This graph is another look at the associations between discharge disability and disability at 6 months.</p>
<p><strong>Observations:</strong></p>
<ul class="simple">
<li><p>Majority of patients with discharge score of 0 or 5 are worse</p></li>
<li><p>Majority of patients with discharge score of 2, 3, or 4 are better</p></li>
</ul>
</div>
<div class="section" id="multiple-linear-regression">
<h2>Multiple linear regression<a class="headerlink" href="#multiple-linear-regression" title="Permalink to this headline">#</a></h2>
<div class="section" id="dataset">
<h3>Dataset<a class="headerlink" href="#dataset" title="Permalink to this headline">#</a></h3>
<p>The dataset is patients who have complete data at each disability timepoint, as well as for stroke severity, age and whether thrombolysed.</p>
<p>In this model, we are predicting change in disability from discharge to six month follow up.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Extract relevant columns and drop rows with NA</span>
<span class="n">reg_df</span> <span class="o">=</span> <span class="n">data_full</span><span class="p">[[</span><span class="s1">&#39;prior_disability&#39;</span><span class="p">,</span> <span class="s1">&#39;stroke_severity&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;thrombolysis&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_disability&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;disability_6_month&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">display</span><span class="p">(</span><span class="n">reg_df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Define predictor and response variables</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">reg_df</span><span class="p">[[</span><span class="s1">&#39;prior_disability&#39;</span><span class="p">,</span> <span class="s1">&#39;stroke_severity&#39;</span><span class="p">,</span> <span class="s1">&#39;age&#39;</span><span class="p">,</span>
            <span class="s1">&#39;thrombolysis&#39;</span><span class="p">,</span> <span class="s1">&#39;discharge_disability&#39;</span><span class="p">]]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">reg_df</span><span class="p">[</span><span class="s1">&#39;disability_6_month&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">reg_df</span><span class="p">[</span><span class="s1">&#39;discharge_disability&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(109321, 7)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="transform-data-fit-model-and-collect-evaluation-metrics">
<h3>Transform data, fit model, and collect evaluation metrics<a class="headerlink" href="#transform-data-fit-model-and-collect-evaluation-metrics" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">standardise_data</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Put features on a similar scale through standardisation.</span>
<span class="sd">    Just transforms features (not response/target variable).</span>
<span class="sd">    Invovles subtracting mean and dividing by standard deviation (SD)</span>
<span class="sd">    of each feature, so data have mean of 0 and SD of 1.</span>
<span class="sd">    Test data is standardised on training data mean and SD.</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># Set up scaling object and fit on training data</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

    <span class="c1"># Apply scaling to training and test data</span>
    <span class="n">train_std</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">test_std</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">train_std</span><span class="p">,</span> <span class="n">test_std</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run_regression</span><span class="p">(</span><span class="n">standardise</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Run regression with 5-fold cross-validation</span>
<span class="sd">    Can choose whether to standardise input variables or not</span>
<span class="sd">    Returns MAE, MSE, RMSE, R2, adjusted R2, feature weights and residuals</span>
<span class="sd">    standardise: True or False</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Set up to create five training/test data splits</span>
    <span class="n">kfold</span> <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Create empty dictionary to store results</span>
    <span class="c1"># (defaultdict so don&#39;t have to pre-define keys)</span>
    <span class="n">reg_results</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>

    <span class="c1"># Use loop to test model on those five different splits</span>
    <span class="k">for</span> <span class="n">train_row</span><span class="p">,</span> <span class="n">test_row</span> <span class="ow">in</span> <span class="n">kfold</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>
        <span class="c1"># Split into training and test data</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">train_row</span><span class="p">],</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">test_row</span><span class="p">]</span>
        <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">train_row</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">test_row</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">standardise</span><span class="p">:</span>
            <span class="c1"># Standardise X data</span>
            <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">standardise_data</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># Set up and fit multiple linear regression</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
        <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

        <span class="c1"># Get feature weights</span>
        <span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;feature_weights&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>

        <span class="c1"># Predict y values using the x test values</span>
        <span class="n">y_test_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

        <span class="c1"># Find residuals (difference between prediction and actual)</span>
        <span class="n">resid</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;actual&#39;</span><span class="p">:</span> <span class="n">y_test</span><span class="p">,</span>
                              <span class="s1">&#39;pred&#39;</span><span class="p">:</span> <span class="n">y_test_pred</span><span class="p">})</span>
        <span class="n">resid</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">resid</span><span class="p">[</span><span class="s1">&#39;actual&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">resid</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">])</span>
        <span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">resid</span><span class="p">)</span>

        <span class="c1"># Use predictions to calculate evaluation metrics</span>
        <span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">))</span>
        <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">)</span>
        <span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;mse&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
        <span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">))</span>
        <span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_test_pred</span><span class="p">))</span>
        <span class="n">adjusted_r2</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span>
                       <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">model</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">))</span> <span class="o">*</span>
                       <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">/</span>
                       <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_train</span><span class="p">)</span><span class="o">-</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;adjusted_r2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">adjusted_r2</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">reg_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run with X variables standardised</span>
<span class="n">reg_results</span> <span class="o">=</span> <span class="n">run_regression</span><span class="p">(</span><span class="n">standardise</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Run without standardisation</span>
<span class="n">reg_results_non_std</span> <span class="o">=</span> <span class="n">run_regression</span><span class="p">(</span><span class="n">standardise</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="review-results">
<h3>Review results<a class="headerlink" href="#review-results" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_regression_results</span><span class="p">(</span><span class="n">results</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Summarise results from regression, based on results dictionary input</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Table of coefficients (as is, and absolute)</span>
    <span class="n">coef</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;feature_weights&#39;</span><span class="p">],</span> <span class="n">columns</span><span class="o">=</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
    <span class="n">mean_coef</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;coef&#39;</span><span class="p">:</span> <span class="n">coef</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span>
                              <span class="s1">&#39;coef_abs&#39;</span><span class="p">:</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coef</span><span class="o">.</span><span class="n">mean</span><span class="p">())})</span>
    <span class="n">mean_coef_sort</span> <span class="o">=</span> <span class="n">mean_coef</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;coef_abs&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">mean_coef_sort</span><span class="p">)</span>

    <span class="c1"># Plot of feature weights</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">mean_coef_sort</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">mean_coef_sort</span><span class="p">[</span><span class="s1">&#39;coef&#39;</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Feature&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Coefficient&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Metrics</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">          Average MAE: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;mae&#39;</span><span class="p">])</span><span class="si">:</span><span class="s1">.9f</span><span class="si">}</span><span class="s1"></span>
<span class="s1">          Average RMSE: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;rmse&#39;</span><span class="p">])</span><span class="si">:</span><span class="s1">.9f</span><span class="si">}</span><span class="s1"></span>
<span class="s1">          Average R-squared: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;r2&#39;</span><span class="p">])</span><span class="si">:</span><span class="s1">.9f</span><span class="si">}</span><span class="s1"></span>
<span class="s1">          Average adjusted R-squared: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;adjusted_r2&#39;</span><span class="p">])</span><span class="si">:</span><span class="s1">.9f</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="standardised-results">
<h4>Standardised results<a class="headerlink" href="#standardised-results" title="Permalink to this headline">#</a></h4>
<p><strong>Understanding outcome score</strong></p>
<p>Outcome is change in disability score between discharge and six-month follow-up (disability_6_month - discharge_disability). <strong>A negative result means that score improved.</strong> A positive result means that the score worsened.</p>
<p><em>Example: Patient sees improvement. They have mRS 3 at discharge and mRS 2 at 6-month. Their outcome would be negative, as score has gone down (2 - 3 = -1).</em></p>
<p><strong>Interpreting the coefficients</strong></p>
<p>These are standardised - they are in units of standard deviation - and hence you can compare the relative importance of each variable, as they are on the same scale. Standardised coefficients reflect the change in outcome (in terms of standard deviation) for every increase of one standard deviation in the predictor.</p>
<ul class="simple">
<li><p><strong>Discharge disability</strong> and <strong>thrombolysis</strong> have negative coefficients. This means that having a higher discharge disability, and receiving thrombolysis, are associated with an <strong>improvement</strong> in disability between discharge and follow-up (a negative change in score).</p></li>
<li><p><strong>Prior disability</strong>, <strong>stroke severity</strong> and <strong>age</strong> have positive coefficients. This means that having a higher prior disability, higher stroke severity, and older age, are associated with a <strong>worsening</strong> in disability between discharge and follow-up (a positive change in score).</p></li>
<li><p>Discharge disability largest, so greatest relative importance.</p></li>
</ul>
<p><strong>Note:</strong> If you have a higher discharge disability, you have <strong>more scope to improve</strong> (e.g. mRS 5 can go down to mRS 1, but mRS 1 can change by a max of 1 to mRS 0). Hence, it is essentially an artefact of the scale and the scope to change. This analysis may therefore feel unhelpful - but should consider that it is still helpful in thinking through what is going on in the data.</p>
<p><strong>Note:</strong> Confounding between discharge disability and stroke severity, as stroke severity can impact/associate with disability at disability and six months - would need to be careful when teasing apart relationship.</p>
<p><strong>Interpreting the metrics</strong></p>
<ul class="simple">
<li><p><strong>MAE</strong>: Mean absolute error. Calculation is to find average of the residuals (which themselves are the difference between actual and predicted values). Lower value implies higher accuracy. Difficult to interpret as generally about comparing accuracy between models and depends on scale in dataset.</p></li>
<li><p><strong>RMSE</strong>: Square root of variance of residuals. Average distance between predicted and observed values. It shows absolute fit of model. Likewise hard to interpret without comparison.</p></li>
<li><p><strong>R-squared</strong>: Relatived fit of model. Also known as coefficient of multiple determination. Percentage of variance explained (variance explained by the model over the total variance). R squared of 17% means that model explains 17% of variation in response variable around the mean.</p></li>
<li><p><strong>Adjusted R-squared:</strong> Important in multiple regression. Issue with R-squared is that it increases with every predictor added to the model, so you may think you have a better fit, the more terms you add, which is misleading. Adjusted R-squared is adjusted for the number of independent variables in the model. It will increase if useful variables are added to the model and decrease if useless variables are added.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Standardised prior to regression</span>
<span class="n">show_regression_results</span><span class="p">(</span><span class="n">reg_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>coef_abs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>discharge_disability</th>
      <td>-0.789904</td>
      <td>0.789904</td>
    </tr>
    <tr>
      <th>prior_disability</th>
      <td>0.414582</td>
      <td>0.414582</td>
    </tr>
    <tr>
      <th>stroke_severity</th>
      <td>0.331800</td>
      <td>0.331800</td>
    </tr>
    <tr>
      <th>age</th>
      <td>0.190118</td>
      <td>0.190118</td>
    </tr>
    <tr>
      <th>thrombolysis</th>
      <td>-0.111061</td>
      <td>0.111061</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/a9d5b6e6f55748c38baa0e13187fa35298d2060b5377287adea54f932d3b87f3.png" src="_images/a9d5b6e6f55748c38baa0e13187fa35298d2060b5377287adea54f932d3b87f3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Average MAE: 1.048413108
          Average RMSE: 1.378388463
          Average R-squared: 0.181646840
          Average adjusted R-squared: 0.181804322
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="unstandardised-results">
<h4>Unstandardised results<a class="headerlink" href="#unstandardised-results" title="Permalink to this headline">#</a></h4>
<p><strong>Interpreting the coefficients</strong></p>
<p>These variables were not standardised, so the coefficients are in their original units.  The coefficients represent the change in the outcome variable, for every one unit increase in the predictor, when the value of all other predictors is held constant. It shows that the relationship remains even when you control for other variables. It does not provide evidence for/against a causal relationship. The <strong>direction of relationships is the same</strong> as in the standardised regression.</p>
<p>Examples:</p>
<ul class="simple">
<li><p><strong>Thrombolysis</strong> coefficient -0.28 means that, on average, if you had thrombolysis, you have a 0.28 improvement in mRS score between discharge and follow-up (association not causal, and of people who were followed up)</p></li>
<li><p><strong>Discharge disability</strong> coefficient -0.51 means having a one mRS score higher discharge disability associates with an improvement of 0.51 in mRS score between discharge and follow-up</p></li>
</ul>
<p><strong>Interpreting the metrics</strong></p>
<p>These are the same as the metrics when unstandardised variables were used. Why is that?</p>
<ul class="simple">
<li><p>Is it because scikit learn standardise for you anyway? No, they don’t do this, we checked the documentation and model code.</p></li>
<li><p>Is it as this is a large dataset?</p></li>
<li><p>Is it as there isn’t huge variation in scales between the variables?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Did not standardise prior to regression</span>
<span class="n">show_regression_results</span><span class="p">(</span><span class="n">reg_results_non_std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef</th>
      <th>coef_abs</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>discharge_disability</th>
      <td>-0.553723</td>
      <td>0.553723</td>
    </tr>
    <tr>
      <th>thrombolysis</th>
      <td>-0.344529</td>
      <td>0.344529</td>
    </tr>
    <tr>
      <th>prior_disability</th>
      <td>0.331157</td>
      <td>0.331157</td>
    </tr>
    <tr>
      <th>stroke_severity</th>
      <td>0.058376</td>
      <td>0.058376</td>
    </tr>
    <tr>
      <th>age</th>
      <td>0.014761</td>
      <td>0.014761</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/0b4f4aa7ea4362cd002ee2ec8d8554049d52526443ca7596d3d96a36b94ca13a.png" src="_images/0b4f4aa7ea4362cd002ee2ec8d8554049d52526443ca7596d3d96a36b94ca13a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          Average MAE: 1.048413108
          Average RMSE: 1.378388463
          Average R-squared: 0.181646840
          Average adjusted R-squared: 0.181804322
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="assumptions">
<h3>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at relationship between actual and predicted values</span>
<span class="k">def</span> <span class="nf">test_linear</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Test assumption of linearity.</span>
<span class="sd">    df is dataframe containing columns with predicted and actual</span>
<span class="sd">    values of the response variable.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Plot actual and predicted values</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;actual&#39;</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;pred&#39;</span><span class="p">]</span>
    <span class="n">jittered_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="mf">0.05</span>
    <span class="n">jittered_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">-</span> <span class="mf">0.05</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">jittered_x</span><span class="p">,</span> <span class="n">jittered_y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Actual value&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Predicted value&#39;</span><span class="p">)</span>

    <span class="c1"># Add diagonal line (based on overall min and max)</span>
    <span class="n">line_coords</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">df</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">line_coords</span><span class="p">,</span> <span class="n">line_coords</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">test_assumptions</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">reg_results</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Tests assumptions of multiple linear regression</span>
<span class="sd">    X: dataframe where each column is a predictor variable</span>
<span class="sd">    reg_results: dictionary output by regression</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Test for linear relationship between each predictor and outcome</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Linearity - look at relationship between each predictor and &#39;</span> <span class="o">+</span>
          <span class="s1">&#39;outcome - or look at</span><span class="se">\n</span><span class="s1">relationship between predicted and actual &#39;</span> <span class="o">+</span>
          <span class="s1">&#39;values (linearity indicated by even spread around diagnoal line)&#39;</span><span class="p">)</span>

    <span class="c1"># Look at linear relationship between each predictor and outcome</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span>
        <span class="n">jittered_x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">-</span> <span class="mf">0.05</span>
        <span class="n">jittered_y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">))</span> <span class="o">-</span> <span class="mf">0.05</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">jittered_x</span><span class="p">,</span> <span class="n">jittered_y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Change in disability from</span><span class="se">\n</span><span class="s1">discharge to followup&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Just plot from first train/test split</span>
    <span class="n">test_linear</span><span class="p">(</span><span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Look at averages (if scatter not meaningful for linearity)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">)):</span>
        <span class="n">averages</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
        <span class="n">averages</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Change in mRS from discharge</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
                         <span class="s1">&#39;to 6-month follow-up&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Test for normally distributed residuals</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Normally distributed residuals:&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;residuals&#39;</span><span class="p">],</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Test for independent observations (just review manually)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Independent observations: review manually</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Test for homoscedasticity</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Homoscedasticity - should be no patterns in distributions of&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;residuals - i.e. the size of error</span><span class="se">\n</span><span class="s1">should not relate to&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;the value of the outcome variable):&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
               <span class="n">reg_results</span><span class="p">[</span><span class="s1">&#39;residuals&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">residuals</span><span class="p">,</span>
               <span class="n">s</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Test for multicolinearity</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Multicolinearity - if there is multicolinearity present, it &#39;</span> <span class="o">+</span>
          <span class="s1">&#39;will result in less precise estimates of individual</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;regression parameters (difficult to decide precisely what&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;each variable contributes) (unstable estimates, may vary</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;alot with addition or removal of data points) (larger&#39;</span> <span class="o">+</span>
          <span class="s1">&#39;sample sizes can better handle multicolinearity)&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="mi">2</span><span class="p">))</span>

    <span class="c1"># Create figure object</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="c1"># Set colours</span>
    <span class="n">cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span>
        <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">])</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">TwoSlopeNorm</span><span class="p">(</span><span class="n">vcenter</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Create heatmap</span>
    <span class="n">heatmap</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>

    <span class="c1"># Add legend for colours</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">heatmap</span><span class="p">)</span>

    <span class="c1"># Show plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Observations:</strong></p>
<ul class="simple">
<li><p>Linearity - not really. Can see most predictions are around -2 to +2 which is not suprising, as that is where the majority of points lie in reality.</p></li>
<li><p>Normally distributed residuals - no (slight left skew)</p></li>
<li><p>Independent observations - yes (as each row is different patient)</p></li>
<li><p>Homoscedasticity - yes, appears so</p></li>
<li><p>Multicolinearity - alright, max is 0.5, so doesn’t appear to be problematic colinearity</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_assumptions</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">reg_results</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linearity - look at relationship between each predictor and outcome - or look at
relationship between predicted and actual values (linearity indicated by even spread around diagnoal line)
</pre></div>
</div>
<img alt="_images/72a0385aa2e56de53c93beb77c1fe1dd990fe9e18736371cc89f9bacbbea9dab.png" src="_images/72a0385aa2e56de53c93beb77c1fe1dd990fe9e18736371cc89f9bacbbea9dab.png" />
<img alt="_images/ad36c3e5f2a1427fcc8662139f0c75ebbb0f36ffdae8fd437462d7552a185add.png" src="_images/ad36c3e5f2a1427fcc8662139f0c75ebbb0f36ffdae8fd437462d7552a185add.png" />
<img alt="_images/2a314e49708f536c66fb1dfc580cb2bffdac5c637667d4b3ed3e0ec71c304bc5.png" src="_images/2a314e49708f536c66fb1dfc580cb2bffdac5c637667d4b3ed3e0ec71c304bc5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Normally distributed residuals:
</pre></div>
</div>
<img alt="_images/9aac0d980d3f74b7d0fc1a897165b037552715566acb2d46a2e4ab337fc2e7d5.png" src="_images/9aac0d980d3f74b7d0fc1a897165b037552715566acb2d46a2e4ab337fc2e7d5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Independent observations: review manually

Homoscedasticity - should be no patterns in distributions ofresiduals - i.e. the size of error
should not relate tothe value of the outcome variable):
</pre></div>
</div>
<img alt="_images/9b3788f9e51df52271d265029e7b3ea7d17bdc88e03318f65d92d97f0254e080.png" src="_images/9b3788f9e51df52271d265029e7b3ea7d17bdc88e03318f65d92d97f0254e080.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Multicolinearity - if there is multicolinearity present, it will result in less precise estimates of individual
regression parameters (difficult to decide precisely whateach variable contributes) (unstable estimates, may vary
alot with addition or removal of data points) (largersample sizes can better handle multicolinearity)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>prior_disability</th>
      <th>stroke_severity</th>
      <th>age</th>
      <th>thrombolysis</th>
      <th>discharge_disability</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>prior_disability</th>
      <td>1.00</td>
      <td>0.21</td>
      <td>0.33</td>
      <td>-0.08</td>
      <td>0.51</td>
    </tr>
    <tr>
      <th>stroke_severity</th>
      <td>0.21</td>
      <td>1.00</td>
      <td>0.10</td>
      <td>0.29</td>
      <td>0.42</td>
    </tr>
    <tr>
      <th>age</th>
      <td>0.33</td>
      <td>0.10</td>
      <td>1.00</td>
      <td>-0.04</td>
      <td>0.29</td>
    </tr>
    <tr>
      <th>thrombolysis</th>
      <td>-0.08</td>
      <td>0.29</td>
      <td>-0.04</td>
      <td>1.00</td>
      <td>-0.02</td>
    </tr>
    <tr>
      <th>discharge_disability</th>
      <td>0.51</td>
      <td>0.42</td>
      <td>0.29</td>
      <td>-0.02</td>
      <td>1.00</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/02686c852fcb0a50da52bc8d0187b7c574aebeef384847e012432a5ff3baa21c.png" src="_images/02686c852fcb0a50da52bc8d0187b7c574aebeef384847e012432a5ff3baa21c.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="sam2_disability_6months_completion.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Disability at six months (completion)</p>
      </div>
    </a>
    <a class="right-next"
       href="sam2_thrombectomy.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Thrombectomy</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#context-about-measurement-of-disability">Context about measurement of disability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#aims">Aims</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#purpose-of-this-analysis">Purpose of this analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#caveats">Caveats</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#set-up">Set up</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reformat-dataset">Reformat dataset</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#disability-at-six-months-and-change-from-discharge">Disability at six months (and change from discharge)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factors-associated-with-disability-at-six-months">Factors associated with disability at six months</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#factors-associated-with-change-in-disability">Factors associated with change in disability</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-linear-regression">Multiple linear regression</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dataset">Dataset</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transform-data-fit-model-and-collect-evaluation-metrics">Transform data, fit model, and collect evaluation metrics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#review-results">Review results</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#standardised-results">Standardised results</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#unstandardised-results">Unstandardised results</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions">Assumptions</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By SAMueL-2 team
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>